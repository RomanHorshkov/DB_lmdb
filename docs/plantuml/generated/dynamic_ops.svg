<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="980px" preserveAspectRatio="none" style="width:1487px;height:980px;background:#FFFFFF;" version="1.1" viewBox="0 0 1487 980" width="1487.5px" zoomAndPan="magnify"><title>Operation flow &#8212; using a DBI descriptor</title><defs/><g><text fill="#000000" font-family="'Arial'" font-size="20.4167" font-weight="bold" lengthAdjust="spacing" textLength="461.7875" x="507.4032" y="40.8262">Operation flow &#8212; using a DBI descriptor</text><rect fill="none" height="113.5449" rx="5.8333" ry="5.8333" style="stroke:#000000;stroke-width:2.1875;" width="628.2857" x="835.1832" y="471.6113"/><g><title>App</title><rect fill="#000000" fill-opacity="0.00000" height="564.4548" width="11.6667" x="25.7765" y="172.9492"/><line style="stroke:#94A3B8;stroke-width:0.7292;stroke-dasharray:7.2917,7.2917;" x1="30.625" x2="30.625" y1="172.9492" y2="737.404"/></g><g><title>ops_. .db_lmdb.h.</title><rect fill="#000000" fill-opacity="0.00000" height="564.4548" width="11.6667" x="354.427" y="172.9492"/><line style="stroke:#94A3B8;stroke-width:0.7292;stroke-dasharray:7.2917,7.2917;" x1="359.962" x2="359.962" y1="172.9492" y2="737.404"/></g><g><title>db_lmdb_dbi cache</title><rect fill="#000000" fill-opacity="0.00000" height="564.4548" width="11.6667" x="727.9739" y="172.9492"/><line style="stroke:#94A3B8;stroke-width:0.7292;stroke-dasharray:7.2917,7.2917;" x1="733.0564" x2="733.0564" y1="172.9492" y2="737.404"/></g><g><title>db_lmdb_ops</title><rect fill="#000000" fill-opacity="0.00000" height="564.4548" width="11.6667" x="916.3115" y="172.9492"/><line style="stroke:#94A3B8;stroke-width:0.7292;stroke-dasharray:7.2917,7.2917;" x1="921.2248" x2="921.2248" y1="172.9492" y2="737.404"/></g><g><title>db_lmdb_core</title><rect fill="#000000" fill-opacity="0.00000" height="564.4548" width="11.6667" x="1284.6375" y="172.9492"/><line style="stroke:#94A3B8;stroke-width:0.7292;stroke-dasharray:7.2917,7.2917;" x1="1289.9407" x2="1289.9407" y1="172.9492" y2="737.404"/></g><g><title>LMDB</title><rect fill="#000000" fill-opacity="0.00000" height="564.4548" width="11.6667" x="1409.3182" y="172.9492"/><line style="stroke:#94A3B8;stroke-width:0.7292;stroke-dasharray:7.2917,7.2917;" x1="1414.9593" x2="1414.9593" y1="172.9492" y2="737.404"/></g><g class="participant participant-head" data-participant="Caller"><text fill="#000000" font-family="'Arial'" font-size="20.4167" lengthAdjust="spacing" textLength="39.8863" x="7.2917" y="168.1342">App</text><ellipse cx="31.6098" cy="74.0788" fill="#E2E2F0" rx="11.6667" ry="11.6667" style="stroke:#181818;stroke-width:0.7292;"/><path d="M31.6098,85.7454 L31.6098,125.1204 M12.6515,97.4121 L50.5681,97.4121 M31.6098,125.1204 L12.6515,146.9954 M31.6098,125.1204 L50.5681,146.9954" fill="none" style="stroke:#181818;stroke-width:0.7292;"/></g><g class="participant participant-tail" data-participant="Caller"><text fill="#000000" font-family="'Arial'" font-size="20.4167" lengthAdjust="spacing" textLength="39.8863" x="7.2917" y="754.8969">App</text><ellipse cx="31.6098" cy="772.1077" fill="#E2E2F0" rx="11.6667" ry="11.6667" style="stroke:#181818;stroke-width:0.7292;"/><path d="M31.6098,783.7744 L31.6098,823.1494 M12.6515,795.4411 L50.5681,795.4411 M31.6098,823.1494 L12.6515,845.0244 M31.6098,823.1494 L50.5681,845.0244" fill="none" style="stroke:#181818;stroke-width:0.7292;"/></g><g class="participant participant-head" data-participant="API"><rect fill="#E5E7EB" height="42.4854" rx="5.8333" ry="5.8333" style="stroke:#1F2937;stroke-width:0.7292;" width="193.0967" x="263.712" y="129.0055"/><text fill="#0F172A" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="172.6801" x="273.9203" y="156.8114">ops_* (db_lmdb.h)</text></g><g class="participant participant-tail" data-participant="API"><rect fill="#E5E7EB" height="42.4854" rx="5.8333" ry="5.8333" style="stroke:#1F2937;stroke-width:0.7292;" width="193.0967" x="263.712" y="735.9456"/><text fill="#0F172A" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="172.6801" x="273.9203" y="763.7515">ops_* (db_lmdb.h)</text></g><g class="participant participant-head" data-participant="DBI"><rect fill="#E5E7EB" height="42.4854" rx="5.8333" ry="5.8333" style="stroke:#1F2937;stroke-width:0.7292;" width="202.7518" x="632.4314" y="129.0055"/><text fill="#0F172A" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="182.3351" x="642.6397" y="156.8114">db_lmdb_dbi cache</text></g><g class="participant participant-tail" data-participant="DBI"><rect fill="#E5E7EB" height="42.4854" rx="5.8333" ry="5.8333" style="stroke:#1F2937;stroke-width:0.7292;" width="202.7518" x="632.4314" y="735.9456"/><text fill="#0F172A" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="182.3351" x="642.6397" y="763.7515">db_lmdb_dbi cache</text></g><g class="participant participant-head" data-participant="Ops"><rect fill="#E5E7EB" height="42.4854" rx="5.8333" ry="5.8333" style="stroke:#1F2937;stroke-width:0.7292;" width="144.7567" x="849.7665" y="129.0055"/><text fill="#0F172A" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="124.34" x="859.9748" y="156.8114">db_lmdb_ops</text></g><g class="participant participant-tail" data-participant="Ops"><rect fill="#E5E7EB" height="42.4854" rx="5.8333" ry="5.8333" style="stroke:#1F2937;stroke-width:0.7292;" width="144.7567" x="849.7665" y="735.9456"/><text fill="#0F172A" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="124.34" x="859.9748" y="763.7515">db_lmdb_ops</text></g><g class="participant participant-head" data-participant="Core"><rect fill="#E5E7EB" height="42.4854" rx="5.8333" ry="5.8333" style="stroke:#1F2937;stroke-width:0.7292;" width="152.7269" x="1214.1074" y="129.0055"/><text fill="#0F172A" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="132.3103" x="1224.3157" y="156.8114">db_lmdb_core</text></g><g class="participant participant-tail" data-participant="Core"><rect fill="#E5E7EB" height="42.4854" rx="5.8333" ry="5.8333" style="stroke:#1F2937;stroke-width:0.7292;" width="152.7269" x="1214.1074" y="735.9456"/><text fill="#0F172A" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="132.3103" x="1224.3157" y="763.7515">db_lmdb_core</text></g><g class="participant participant-head" data-participant="LMDB"><text fill="#000000" font-family="'Arial'" font-size="20.4167" lengthAdjust="spacing" textLength="58.7179" x="1381.4176" y="168.1342">LMDB</text><path d="M1388.9016,96.6829 C1388.9016,82.0996 1415.1516,82.0996 1415.1516,82.0996 C1415.1516,82.0996 1441.4016,82.0996 1441.4016,96.6829 L1441.4016,134.5996 C1441.4016,149.1829 1415.1516,149.1829 1415.1516,149.1829 C1415.1516,149.1829 1388.9016,149.1829 1388.9016,134.5996 L1388.9016,96.6829" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.7292;"/><path d="M1388.9016,96.6829 C1388.9016,111.2663 1415.1516,111.2663 1415.1516,111.2663 C1415.1516,111.2663 1441.4016,111.2663 1441.4016,96.6829" fill="none" style="stroke:#181818;stroke-width:0.7292;"/></g><g class="participant participant-tail" data-participant="LMDB"><text fill="#000000" font-family="'Arial'" font-size="20.4167" lengthAdjust="spacing" textLength="58.7179" x="1381.4176" y="754.8969">LMDB</text><path d="M1388.9016,774.2952 C1388.9016,759.7119 1415.1516,759.7119 1415.1516,759.7119 C1415.1516,759.7119 1441.4016,759.7119 1441.4016,774.2952 L1441.4016,812.2119 C1441.4016,826.7952 1415.1516,826.7952 1415.1516,826.7952 C1415.1516,826.7952 1388.9016,826.7952 1388.9016,812.2119 L1388.9016,774.2952" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.7292;"/><path d="M1388.9016,774.2952 C1388.9016,788.8786 1415.1516,788.8786 1415.1516,788.8786 C1415.1516,788.8786 1441.4016,788.8786 1441.4016,774.2952" fill="none" style="stroke:#181818;stroke-width:0.7292;"/></g><g class="message" data-participant-1="Caller" data-participant-2="API"><polygon fill="#2563EB" points="342.7603,212.5179,357.3436,218.3512,342.7603,224.1846,348.5936,218.3512" style="stroke:#2563EB;stroke-width:1.4583;"/><line style="stroke:#2563EB;stroke-width:2.1875;" x1="31.6098" x2="351.5103" y1="218.3512" y2="218.3512"/><text fill="#000000" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="293.6505" x="49.1098" y="210.9634">ops_exec(desc_id, work_items)</text></g><g class="message" data-participant-1="API" data-participant-2="DBI"><polygon fill="#2563EB" points="716.3073,255.0033,730.8906,260.8366,716.3073,266.6699,722.1406,260.8366" style="stroke:#2563EB;stroke-width:1.4583;"/><line style="stroke:#2563EB;stroke-width:2.1875;" x1="360.2603" x2="725.0573" y1="260.8366" y2="260.8366"/><text fill="#000000" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="338.547" x="377.7603" y="253.4488">lookup dbi_desc_t by id (db.h/dbi.h)</text></g><g class="message" data-participant-1="API" data-participant-2="Ops"><polygon fill="#2563EB" points="904.6448,297.4886,919.2282,303.3219,904.6448,309.1553,910.4782,303.3219" style="stroke:#2563EB;stroke-width:1.4583;"/><line style="stroke:#2563EB;stroke-width:2.1875;" x1="360.2603" x2="913.3948" y1="303.3219" y2="303.3219"/><text fill="#000000" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="349.4239" x="466.4906" y="295.9341">ops_exec_internal(desc, work_items)</text></g><g class="message" data-participant-1="Ops" data-participant-2="Core"><polygon fill="#2563EB" points="1272.9708,339.974,1287.5542,345.8073,1272.9708,351.6406,1278.8042,345.8073" style="stroke:#2563EB;stroke-width:1.4583;"/><line style="stroke:#2563EB;stroke-width:2.1875;" x1="922.1448" x2="1281.7208" y1="345.8073" y2="345.8073"/><text fill="#000000" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="333.326" x="939.6448" y="338.4195">db_lmdb_txn_begin_safe(DB-&gt;env)</text></g><g class="message" data-participant-1="Ops" data-participant-2="Ops"><line style="stroke:#2563EB;stroke-width:2.1875;" x1="922.1448" x2="983.3948" y1="388.2926" y2="388.2926"/><line style="stroke:#2563EB;stroke-width:2.1875;" x1="983.3948" x2="983.3948" y1="388.2926" y2="407.251"/><line style="stroke:#2563EB;stroke-width:2.1875;" x1="923.6032" x2="983.3948" y1="407.251" y2="407.251"/><polygon fill="#2563EB" points="938.1865,401.4176,923.6032,407.251,938.1865,413.0843,932.3532,407.251" style="stroke:#2563EB;stroke-width:1.4583;"/><text fill="#000000" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="334.0018" x="932.3532" y="380.9048">batch work in void_store (ops-only)</text></g><g class="message" data-participant-1="Ops" data-participant-2="LMDB"><polygon fill="#2563EB" points="1397.6516,443.903,1412.2349,449.7363,1397.6516,455.5697,1403.4849,449.7363" style="stroke:#2563EB;stroke-width:1.4583;"/><line style="stroke:#2563EB;stroke-width:2.1875;" x1="922.1448" x2="1406.4016" y1="449.7363" y2="449.7363"/><text fill="#000000" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="308.6098" x="1014.3433" y="442.3485">mdb_put / mdb_get / mdb_del ...</text></g><path d="M841.0165,471.6113 L931.3434,471.6113 L931.3434,483.7109 L916.7601,498.2943 L835.1832,498.2943 L835.1832,477.4447 A5.8333,5.8333 0 0 1 841.0165,471.6113" fill="#EEEEEE" style="stroke:#000000;stroke-width:2.1875;"/><rect fill="none" height="113.5449" rx="5.8333" ry="5.8333" style="stroke:#000000;stroke-width:2.1875;" width="628.2857" x="835.1832" y="471.6113"/><text fill="#000000" font-family="'Arial'" font-size="20.4167" font-weight="bold" lengthAdjust="spacing" textLength="30.5353" x="857.0582" y="492.0209">alt</text><text fill="#000000" font-family="'Arial'" font-size="20.4167" font-weight="bold" lengthAdjust="spacing" textLength="258.9268" x="953.2184" y="493.4792">[needs resize or retry]</text><g class="message" data-participant-1="Core" data-participant-2="Ops"><polygon fill="#2563EB" points="938.1865,525.1709,923.6032,531.0042,938.1865,536.8376,932.3532,531.0042" style="stroke:#2563EB;stroke-width:1.4583;"/><line style="stroke:#2563EB;stroke-width:2.1875;stroke-dasharray:2.9167,2.9167;" x1="929.4365" x2="1289.0125" y1="531.0042" y2="531.0042"/><text fill="#000000" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="194.1748" x="1009.2204" y="523.6164">retry_with_resize(...)</text></g><g class="message" data-participant-1="Ops" data-participant-2="LMDB"><polygon fill="#2563EB" points="1397.6516,567.6563,1412.2349,573.4896,1397.6516,579.3229,1403.4849,573.4896" style="stroke:#2563EB;stroke-width:1.4583;"/><line style="stroke:#2563EB;stroke-width:2.1875;" x1="922.1448" x2="1406.4016" y1="573.4896" y2="573.4896"/><text fill="#000000" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="192.9992" x="1072.1486" y="566.1018">re-run op in new txn</text></g><g class="message" data-participant-1="Ops" data-participant-2="Core"><polygon fill="#2563EB" points="1272.9708,620.3499,1287.5542,626.1833,1272.9708,632.0166,1278.8042,626.1833" style="stroke:#2563EB;stroke-width:1.4583;"/><line style="stroke:#2563EB;stroke-width:2.1875;" x1="922.1448" x2="1281.7208" y1="626.1833" y2="626.1833"/><text fill="#000000" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="297.4089" x="957.6034" y="618.7955">db_lmdb_txn_commit_safe(txn)</text></g><g class="message" data-participant-1="Ops" data-participant-2="API"><polygon fill="#2563EB" points="376.302,662.8353,361.7186,668.6686,376.302,674.502,370.4686,668.6686" style="stroke:#2563EB;stroke-width:1.4583;"/><line style="stroke:#2563EB;stroke-width:2.1875;stroke-dasharray:2.9167,2.9167;" x1="367.552" x2="920.6865" y1="668.6686" y2="668.6686"/><text fill="#000000" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="158.8316" x="561.7868" y="661.2808">result/error code</text></g><g class="message" data-participant-1="API" data-participant-2="Caller"><polygon fill="#2563EB" points="47.6515,705.3206,33.0681,711.154,47.6515,716.9873,41.8181,711.154" style="stroke:#2563EB;stroke-width:1.4583;"/><line style="stroke:#2563EB;stroke-width:2.1875;stroke-dasharray:2.9167,2.9167;" x1="38.9015" x2="358.802" y1="711.154" y2="711.154"/><text fill="#000000" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="161.5809" x="115.1446" y="703.7662">status + payload</text></g><rect fill="none" height="85.8822" rx="5.8333" ry="5.8333" style="stroke:#000000;stroke-width:1.4583;" width="650.5206" x="808.5732" y="866.1702"/><text fill="#000000" font-family="'Arial'" font-size="20.4167" lengthAdjust="spacing" textLength="534.4222" x="815.8649" y="892.4131">- dbi_desc_t bridges public callers and DBI internals.</text><text fill="#000000" font-family="'Arial'" font-size="20.4167" lengthAdjust="spacing" textLength="524.0544" x="815.8649" y="916.1794">- void_store is ops-only; never leak buffers upward.</text><text fill="#000000" font-family="'Arial'" font-size="20.4167" lengthAdjust="spacing" textLength="635.9373" x="815.8649" y="939.9457">- Retry/resize stays inside db_lmdb_core for uniform behavior.</text><!--SRC=[VLNRJjj047ttLupIXoPjun0W1L89AGb4GeA22dssrjwnlSfcrzrTvzAgKZ-YNzWlwQoTW0sqUR6pvypCEJDZ-otSEwOuareXt4cctDURQqYr0LsWOKve1QdKQ-Wg3RXnQ1IJ85GYIuws5mPs8LJ135k2pHdNQw4oI9cqs42CBXMVQQFGm6dZF6R98jk1aag-cLU_1eCN0eR71yqJJ5aftLmhzvaj4JeJ8vZilCwu5z-Hub-23sHb8aMcbgWSI4nTWpCnHgztYWv77uykfy_1Xrma2uNMmZ0SFGUV2XyrkuFVIbG9mey0Ngi0S2rIl1OAfzfmD3lqx7XoD3rjeYzwTZgVp6V4k6F6YKGKDCDMYk7yyEpev1dXUPRBqUL9fQ91yaPsyC5yU78uUGdlVGBSK3TOXbLJ8Q6keg7JgTwqjCoc5wFBuGxuXvEVGU24amYtxGtyy-itbDRl5uEBwHMDqYP654wR8609NM1I5C0ip9YKLBruaWgJkokFT7HXetVGvN4abpmEyrwdHVDfFMs7HpmMaB0anpRjjh0j6cLj4sZNiSL8wA0JSEPOp2p2zSt5jCBzJIS8QiNGFw-4Zi7Bn0qcNUyn4lm3hBLPHCBXqlO2po6g5pi6gVMYB82KHXNPGRm5mRt7C1_GCPdSHtZTJyaZeUh7kQhIBk6P553v6CFUXTkeACPCgCYo5BiNq_uvgjKZkquVCvVaLJ9wJS1A2nvPv_DqgN1VAxbz3AZQC0QVkYWT3Agx3FTt72M4OHWmwK0XSWi6hLyu6hL1PxQqHr1hx3-Mhu1eBLmUrUmkfUXLp7PLWtrJAkg6bwbm3UGkGCN_uptHowLmjNdwl_FnE3MgHw-M0TB3RI3H7Ek- -rprVCTW7NEbXVTGiAtKZ0U1n8oAWX5Pxe9-Quv6y0mj56KiHK9xw7FGuX7RZtu_FHjIMAFDmiA-qP_8ruhgIcGBYCiqzV5biMQ6-w0llbM3NKz9sTPIKYiuGdDjguz1gGHTw8sDELi9RKBVgLhwNm00]--></g></svg>