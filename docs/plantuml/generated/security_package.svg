<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="339px" preserveAspectRatio="none" style="width:480px;height:339px;" version="1.1" viewBox="0 0 480 339" width="480px" zoomAndPan="magnify"><defs><filter height="300%" id="f12u4hj1tgw8i9" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="350" x="71" y="16.708">Security package — LMDB safety policy</text><!--MD5=[109515bbac35f821417e1764695b17cb]
cluster Security--><polygon fill="#FFFFFF" filter="url(#f12u4hj1tgw8i9)" points="22,44.9531,93,44.9531,100,67.25,458,67.25,458,327.9531,22,327.9531,22,44.9531" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="22" x2="100" y1="67.25" y2="67.25"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="65" x="26" y="59.9482">Security</text><!--MD5=[5467e60ae5bbbd83eb345bff18489f4a]
entity sec_h--><rect fill="#FEFECE" filter="url(#f12u4hj1tgw8i9)" height="52.5938" style="stroke: #A80036; stroke-width: 1.5;" width="89" x="37.5" y="249.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="32.5" y="254.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="32.5" y="292.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="69" x="47.5" y="272.9482">«internal»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="48.5" y="289.2451">security.h</text><path d="M162,240.9531 L162,272.4531 L126.84,276.4531 L162,280.4531 L162,311.4844 A0,0 0 0 0 162,311.4844 L412,311.4844 A0,0 0 0 0 412,311.4844 L412,250.9531 L402,240.9531 L162,240.9531 A0,0 0 0 0 162,240.9531 " fill="#FBFB77" filter="url(#f12u4hj1tgw8i9)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M402,240.9531 L402,250.9531 L412,250.9531 L402,240.9531 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="228" x="168" y="258.02">Defines db_security_ret_code_t and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="168" y="273.1528">security_check(...) interface.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="212" x="168" y="288.2856">Used by ops to interpret LMDB rc</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="168" y="303.4185">and decide SUCCESS / RETRY / FAIL.</text><!--MD5=[81f4f006f79260fa354724ac910ba927]
entity sec_c--><rect fill="#FEFECE" filter="url(#f12u4hj1tgw8i9)" height="52.5938" style="stroke: #A80036; stroke-width: 1.5;" width="89" x="37.5" y="103.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="32.5" y="108.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="32.5" y="146.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="69" x="47.5" y="126.9482">«internal»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="66" x="49" y="143.2451">security.c</text><path d="M162,79.9531 L162,126.4531 L126.69,130.4531 L162,134.4531 L162,180.75 A0,0 0 0 0 162,180.75 L442,180.75 A0,0 0 0 0 442,180.75 L442,89.9531 L432,79.9531 L162,79.9531 A0,0 0 0 0 162,79.9531 " fill="#FBFB77" filter="url(#f12u4hj1tgw8i9)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M432,79.9531 L432,89.9531 L442,89.9531 L432,79.9531 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="80" x="168" y="97.02">Implements:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="168" y="112.1528">- LMDB -&gt; errno mapping</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="168" y="127.2856">- safety policy (retry / fail)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="259" x="168" y="142.4185">- mapsize expansion on MDB_MAP_FULL</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="217" x="168" y="157.5513">All LMDB error handling flows here</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="190" x="168" y="172.6841">before reaching higher layers.</text><!--MD5=[8ecddc6b1492d2ff288a63d6eb9bff24]
link sec_c to sec_h--><path d="M82,157.1931 C82,181.7731 82,218.8031 82,244.8731 " fill="none" id="sec_c-&gt;sec_h" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="82,249.9331,86,240.9331,82,244.9331,78,240.9331,82,249.9331" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[a5ca4fb2a9d18c0695d95923562e2583]
@startuml

title Security package — LMDB safety policy

package "Security" {
  component "security.h" <<internal>> as sec_h
    note right of sec_h
    Defines db_security_ret_code_t and
    security_check(...) interface.
    Used by ops to interpret LMDB rc
    and decide SUCCESS / RETRY / FAIL.
    end note
  component "security.c" <<internal>> as sec_c
    note right of sec_c
    Implements:
    - LMDB -> errno mapping
    - safety policy (retry / fail)
    - mapsize expansion on MDB_MAP_FULL
    All LMDB error handling flows here
    before reaching higher layers.
    end note
}

sec_c - -> sec_h


@enduml

PlantUML version 1.2020.02(Sun Mar 01 11:22:07 CET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 21.0.8+9-Ubuntu-0ubuntu124.04.1
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>