<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1022.2917px" preserveAspectRatio="none" style="width:1844px;height:1022px;background:#FFFFFF;" version="1.1" viewBox="0 0 1844 1022" width="1844.7917px" zoomAndPan="magnify"><title>Init flow &#8212; env + DBI setup</title><defs/><g><text fill="#000000" font-family="'Arial'" font-size="20.4167" font-weight="bold" lengthAdjust="spacing" textLength="314.5343" x="759.6955" y="40.8262">Init flow &#8212; env + DBI setup</text><rect fill="none" height="174.9886" rx="5.8333" ry="5.8333" style="stroke:#000000;stroke-width:2.1875;" width="852.6048" x="949.045" y="452.653"/><g><title>App</title><rect fill="#000000" fill-opacity="0.00000" height="606.9401" width="11.6667" x="25.7765" y="172.9492"/><line style="stroke:#94A3B8;stroke-width:0.7292;stroke-dasharray:7.2917,7.2917;" x1="30.625" x2="30.625" y1="172.9492" y2="779.8893"/></g><g><title>db_lmdb_init</title><rect fill="#000000" fill-opacity="0.00000" height="606.9401" width="11.6667" x="453.0325" y="172.9492"/><line style="stroke:#94A3B8;stroke-width:0.7292;stroke-dasharray:7.2917,7.2917;" x1="458.251" x2="458.251" y1="172.9492" y2="779.8893"/></g><g><title>db_lmdb_core</title><rect fill="#000000" fill-opacity="0.00000" height="606.9401" width="11.6667" x="1034.1584" y="172.9492"/><line style="stroke:#94A3B8;stroke-width:0.7292;stroke-dasharray:7.2917,7.2917;" x1="1039.4616" x2="1039.4616" y1="172.9492" y2="779.8893"/></g><g><title>db_lmdb_dbi_init</title><rect fill="#000000" fill-opacity="0.00000" height="606.9401" width="11.6667" x="1464.2286" y="172.9492"/><line style="stroke:#94A3B8;stroke-width:0.7292;stroke-dasharray:7.2917,7.2917;" x1="1468.9981" x2="1468.9981" y1="172.9492" y2="779.8893"/></g><g><title>LMDB</title><rect fill="#000000" fill-opacity="0.00000" height="606.9401" width="11.6667" x="1788.5248" y="172.9492"/><line style="stroke:#94A3B8;stroke-width:0.7292;stroke-dasharray:7.2917,7.2917;" x1="1794.1659" x2="1794.1659" y1="172.9492" y2="779.8893"/></g><g class="participant participant-head" data-participant="Caller"><text fill="#000000" font-family="'Arial'" font-size="20.4167" lengthAdjust="spacing" textLength="39.8863" x="7.2917" y="168.1342">App</text><ellipse cx="31.6098" cy="74.0788" fill="#E2E2F0" rx="11.6667" ry="11.6667" style="stroke:#181818;stroke-width:0.7292;"/><path d="M31.6098,85.7454 L31.6098,125.1204 M12.6515,97.4121 L50.5681,97.4121 M31.6098,125.1204 L12.6515,146.9954 M31.6098,125.1204 L50.5681,146.9954" fill="none" style="stroke:#181818;stroke-width:0.7292;"/></g><g class="participant participant-tail" data-participant="Caller"><text fill="#000000" font-family="'Arial'" font-size="20.4167" lengthAdjust="spacing" textLength="39.8863" x="7.2917" y="797.3822">App</text><ellipse cx="31.6098" cy="814.5931" fill="#E2E2F0" rx="11.6667" ry="11.6667" style="stroke:#181818;stroke-width:0.7292;"/><path d="M31.6098,826.2598 L31.6098,865.6348 M12.6515,837.9264 L50.5681,837.9264 M31.6098,865.6348 L12.6515,887.5098 M31.6098,865.6348 L50.5681,887.5098" fill="none" style="stroke:#181818;stroke-width:0.7292;"/></g><g class="participant participant-head" data-participant="API"><rect fill="#E5E7EB" height="42.4854" rx="5.8333" ry="5.8333" style="stroke:#1F2937;stroke-width:0.7292;" width="141.2298" x="388.251" y="129.0055"/><text fill="#0F172A" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="120.8131" x="398.4593" y="156.8114">db_lmdb_init</text></g><g class="participant participant-tail" data-participant="API"><rect fill="#E5E7EB" height="42.4854" rx="5.8333" ry="5.8333" style="stroke:#1F2937;stroke-width:0.7292;" width="141.2298" x="388.251" y="778.431"/><text fill="#0F172A" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="120.8131" x="398.4593" y="806.2369">db_lmdb_init</text></g><g class="participant participant-head" data-participant="Core"><rect fill="#E5E7EB" height="42.4854" rx="5.8333" ry="5.8333" style="stroke:#1F2937;stroke-width:0.7292;" width="152.7269" x="963.6283" y="129.0055"/><text fill="#0F172A" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="132.3103" x="973.8366" y="156.8114">db_lmdb_core</text></g><g class="participant participant-tail" data-participant="Core"><rect fill="#E5E7EB" height="42.4854" rx="5.8333" ry="5.8333" style="stroke:#1F2937;stroke-width:0.7292;" width="152.7269" x="963.6283" y="778.431"/><text fill="#0F172A" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="132.3103" x="973.8366" y="806.2369">db_lmdb_core</text></g><g class="participant participant-head" data-participant="DBI"><rect fill="#E5E7EB" height="42.4854" rx="5.8333" ry="5.8333" style="stroke:#1F2937;stroke-width:0.7292;" width="180.0444" x="1380.0398" y="129.0055"/><text fill="#0F172A" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="159.6277" x="1390.2481" y="156.8114">db_lmdb_dbi_init</text></g><g class="participant participant-tail" data-participant="DBI"><rect fill="#E5E7EB" height="42.4854" rx="5.8333" ry="5.8333" style="stroke:#1F2937;stroke-width:0.7292;" width="180.0444" x="1380.0398" y="778.431"/><text fill="#0F172A" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="159.6277" x="1390.2481" y="806.2369">db_lmdb_dbi_init</text></g><g class="participant participant-head" data-participant="LMDB"><text fill="#000000" font-family="'Arial'" font-size="20.4167" lengthAdjust="spacing" textLength="58.7179" x="1760.6242" y="168.1342">LMDB</text><path d="M1768.1081,96.6829 C1768.1081,82.0996 1794.3581,82.0996 1794.3581,82.0996 C1794.3581,82.0996 1820.6081,82.0996 1820.6081,96.6829 L1820.6081,134.5996 C1820.6081,149.1829 1794.3581,149.1829 1794.3581,149.1829 C1794.3581,149.1829 1768.1081,149.1829 1768.1081,134.5996 L1768.1081,96.6829" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.7292;"/><path d="M1768.1081,96.6829 C1768.1081,111.2663 1794.3581,111.2663 1794.3581,111.2663 C1794.3581,111.2663 1820.6081,111.2663 1820.6081,96.6829" fill="none" style="stroke:#181818;stroke-width:0.7292;"/></g><g class="participant participant-tail" data-participant="LMDB"><text fill="#000000" font-family="'Arial'" font-size="20.4167" lengthAdjust="spacing" textLength="58.7179" x="1760.6242" y="797.3822">LMDB</text><path d="M1768.1081,816.7806 C1768.1081,802.1973 1794.3581,802.1973 1794.3581,802.1973 C1794.3581,802.1973 1820.6081,802.1973 1820.6081,816.7806 L1820.6081,854.6973 C1820.6081,869.2806 1794.3581,869.2806 1794.3581,869.2806 C1794.3581,869.2806 1768.1081,869.2806 1768.1081,854.6973 L1768.1081,816.7806" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.7292;"/><path d="M1768.1081,816.7806 C1768.1081,831.3639 1794.3581,831.3639 1794.3581,831.3639 C1794.3581,831.3639 1820.6081,831.3639 1820.6081,816.7806" fill="none" style="stroke:#181818;stroke-width:0.7292;"/></g><g class="message" data-participant-1="Caller" data-participant-2="API"><polygon fill="#2563EB" points="441.3659,212.5179,455.9492,218.3512,441.3659,224.1846,447.1992,218.3512" style="stroke:#2563EB;stroke-width:1.4583;"/><line style="stroke:#2563EB;stroke-width:2.1875;" x1="31.6098" x2="450.1159" y1="218.3512" y2="218.3512"/><text fill="#000000" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="392.2561" x="49.1098" y="210.9634">db_lmdb_init(dbi_decls, n_dbis, meta_dir)</text></g><g class="message" data-participant-1="API" data-participant-2="Core"><polygon fill="#2563EB" points="1022.4918,255.0033,1037.0751,260.8366,1022.4918,266.6699,1028.3251,260.8366" style="stroke:#2563EB;stroke-width:1.4583;"/><line style="stroke:#2563EB;stroke-width:2.1875;" x1="458.8659" x2="1031.2418" y1="260.8366" y2="260.8366"/><text fill="#000000" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="546.1259" x="476.3659" y="253.4488">db_lmdb_create_env_safe(meta_dir, max_dbis, map_size)</text></g><g class="message" data-participant-1="Core" data-participant-2="LMDB"><polygon fill="#2563EB" points="1776.8581,297.4886,1791.4414,303.3219,1776.8581,309.1553,1782.6914,303.3219" style="stroke:#2563EB;stroke-width:1.4583;"/><line style="stroke:#2563EB;stroke-width:2.1875;" x1="1039.9918" x2="1785.6081" y1="303.3219" y2="303.3219"/><text fill="#000000" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="535.036" x="1149.6569" y="295.9341">mdb_env_create / set_maxdbs / set_mapsize / env_open</text></g><g class="message" data-participant-1="Core" data-participant-2="API"><polygon fill="#2563EB" points="474.9075,339.974,460.3242,345.8073,474.9075,351.6406,469.0742,345.8073" style="stroke:#2563EB;stroke-width:1.4583;"/><line style="stroke:#2563EB;stroke-width:2.1875;stroke-dasharray:2.9167,2.9167;" x1="466.1575" x2="1038.5334" y1="345.8073" y2="345.8073"/><text fill="#000000" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="145.5848" x="676.6364" y="338.4195">DB-&gt;env ready</text></g><g class="message" data-participant-1="API" data-participant-2="DBI"><polygon fill="#2563EB" points="1452.562,382.4593,1467.1453,388.2926,1452.562,394.126,1458.3953,388.2926" style="stroke:#2563EB;stroke-width:1.4583;"/><line style="stroke:#2563EB;stroke-width:2.1875;" x1="458.8659" x2="1461.312" y1="388.2926" y2="388.2926"/><text fill="#000000" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="296.4461" x="816.2408" y="380.9048">db_lmdb_dbi_init(decls, n_dbis)</text></g><g class="message" data-participant-1="DBI" data-participant-2="Core"><polygon fill="#2563EB" points="1056.0334,424.9447,1041.4501,430.778,1056.0334,436.6113,1050.2001,430.778" style="stroke:#2563EB;stroke-width:1.4583;"/><line style="stroke:#2563EB;stroke-width:2.1875;" x1="1047.2834" x2="1468.6036" y1="430.778" y2="430.778"/><text fill="#000000" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="333.326" x="1088.3639" y="423.3902">db_lmdb_txn_begin_safe(DB-&gt;env)</text></g><path d="M954.8783,452.653 L1064.3359,452.653 L1064.3359,464.7526 L1049.7526,479.3359 L949.045,479.3359 L949.045,458.4863 A5.8333,5.8333 0 0 1 954.8783,452.653" fill="#EEEEEE" style="stroke:#000000;stroke-width:2.1875;"/><rect fill="none" height="174.9886" rx="5.8333" ry="5.8333" style="stroke:#000000;stroke-width:2.1875;" width="852.6048" x="949.045" y="452.653"/><text fill="#000000" font-family="'Arial'" font-size="20.4167" font-weight="bold" lengthAdjust="spacing" textLength="49.6659" x="970.92" y="473.0625">loop</text><text fill="#000000" font-family="'Arial'" font-size="20.4167" font-weight="bold" lengthAdjust="spacing" textLength="234.0839" x="1086.2109" y="474.5209">[for each dbi_init_t]</text><g class="message" data-participant-1="DBI" data-participant-2="Core"><polygon fill="#2563EB" points="1056.0334,506.2126,1041.4501,512.0459,1056.0334,517.8792,1050.2001,512.0459" style="stroke:#2563EB;stroke-width:1.4583;"/><line style="stroke:#2563EB;stroke-width:2.1875;" x1="1047.2834" x2="1468.6036" y1="512.0459" y2="512.0459"/><text fill="#000000" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="395.0702" x="1057.4918" y="504.6581">db_lmdb_dbi_open_safe(txn, name, flags)</text></g><g class="message" data-participant-1="DBI" data-participant-2="Core"><polygon fill="#2563EB" points="1056.0334,548.6979,1041.4501,554.5313,1056.0334,560.3646,1050.2001,554.5313" style="stroke:#2563EB;stroke-width:1.4583;"/><line style="stroke:#2563EB;stroke-width:2.1875;" x1="1047.2834" x2="1468.6036" y1="554.5313" y2="554.5313"/><text fill="#000000" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="351.8863" x="1079.0837" y="547.1435">db_lmdb_dbi_get_flags_safe(txn, dbi)</text></g><g class="message" data-participant-1="DBI" data-participant-2="DBI"><line style="stroke:#2563EB;stroke-width:2.1875;stroke-dasharray:2.9167,2.9167;" x1="1470.062" x2="1531.312" y1="597.0166" y2="597.0166"/><line style="stroke:#2563EB;stroke-width:2.1875;stroke-dasharray:2.9167,2.9167;" x1="1531.312" x2="1531.312" y1="597.0166" y2="615.9749"/><line style="stroke:#2563EB;stroke-width:2.1875;stroke-dasharray:2.9167,2.9167;" x1="1471.5203" x2="1531.312" y1="615.9749" y2="615.9749"/><polygon fill="#2563EB" points="1486.1036,610.1416,1471.5203,615.9749,1486.1036,621.8083,1480.2703,615.9749" style="stroke:#2563EB;stroke-width:1.4583;"/><text fill="#000000" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="303.8795" x="1480.2703" y="589.6288">cache dbi_desc_t (flags, names)</text></g><g class="message" data-participant-1="DBI" data-participant-2="Core"><polygon fill="#2563EB" points="1056.0334,662.8353,1041.4501,668.6686,1056.0334,674.502,1050.2001,668.6686" style="stroke:#2563EB;stroke-width:1.4583;"/><line style="stroke:#2563EB;stroke-width:2.1875;" x1="1047.2834" x2="1468.6036" y1="668.6686" y2="668.6686"/><text fill="#000000" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="297.4089" x="1106.3224" y="661.2808">db_lmdb_txn_commit_safe(txn)</text></g><g class="message" data-participant-1="DBI" data-participant-2="API"><polygon fill="#2563EB" points="474.9075,705.3206,460.3242,711.154,474.9075,716.9873,469.0742,711.154" style="stroke:#2563EB;stroke-width:1.4583;"/><line style="stroke:#2563EB;stroke-width:2.1875;stroke-dasharray:2.9167,2.9167;" x1="466.1575" x2="1468.6036" y1="711.154" y2="711.154"/><text fill="#000000" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="297.4366" x="815.7456" y="703.7662">descriptors stored on DB-&gt;dbis</text></g><g class="message" data-participant-1="API" data-participant-2="Caller"><polygon fill="#2563EB" points="47.6515,747.806,33.0681,753.6393,47.6515,759.4727,41.8181,753.6393" style="stroke:#2563EB;stroke-width:1.4583;"/><line style="stroke:#2563EB;stroke-width:2.1875;stroke-dasharray:2.9167,2.9167;" x1="38.9015" x2="457.4075" y1="753.6393" y2="753.6393"/><text fill="#000000" font-family="'Arial'" font-size="18.9583" lengthAdjust="spacing" textLength="193.3509" x="148.5624" y="746.2515">ready for operations</text></g><rect fill="none" height="85.8822" rx="5.8333" ry="5.8333" style="stroke:#000000;stroke-width:1.4583;" width="599.3593" x="1217.066" y="908.6556"/><text fill="#000000" font-family="'Arial'" font-size="20.4167" lengthAdjust="spacing" textLength="351.2703" x="1224.3577" y="934.8985">- DB owns env + dbi_desc_t array.</text><text fill="#000000" font-family="'Arial'" font-size="20.4167" lengthAdjust="spacing" textLength="549.4755" x="1224.3577" y="958.6648">- All LMDB calls only via db_lmdb_core safe wrappers.</text><text fill="#000000" font-family="'Arial'" font-size="20.4167" lengthAdjust="spacing" textLength="584.776" x="1224.3577" y="982.431">- Logging routes through internal.h &#8594; EMlog (not shown).</text><!--SRC=[VLNRRjf047ttLupeGq5DQ0YXkJn4ihb8aQ2AbFJP6kp1hBBikhjB8QqgzQaVKFKByoMTjGqOICE3iNVEcJbpFEjz3myELOfIAu9xYSfzcOnXfWq89HpCf5v1KscWjIEZKF9o8fSfsLOxi4z2vMXm0NQEgLu9bS4CfQLQnEYbIllQA39mLLkVOlAKLK79rTwDYbyDaUO2EXTdzHMQuLAwaLRkCou86g4HA1kl8nx4TsB-SV2HMmcboDI2b0D9CrV3XCReLQNelFUfEumEWuzpaJmfiXOwxTvXS5UuMtU7lYv99GG_0dYj0i1Op6Wi54NQf6IgwFL5s8skwj4Zpwv6uQZFY7iqJYGYvzUtbw8pEh_kNXu03hCCUyFBGaKDv1kfmcUZpkLvU1pUz0amOJSmey9KIDXLChmQwVMUbduqw0qxLU0_dVmC0YUS9BZR3j_Bhxz0wXjyW45qnrQwPHu4c3XcXNaEQA6FKdB5V2SFmlix7scaqrWk-E9dkR67u96aFKZ22_iGNw-EIAUYIfIYmobQWl5a41KOVzC8Wb8AdDuM2cwWNh_f-Iabqfw0yiduVq4EurIOLk3nJ2jaxNY98NGKS_-nnHarDtXcudgJ0_FOyhje1GMPanIgRi0dyCmo2NpqviNCIwTs-v1x9ZzvdCv9LJcs3GoYqrllFgT8duEDIk_CJkJ6b-PUSwt0euvRSciLJoaJgkoeAj0AfDPvyTqXJEQmyIfsF300hwVo82-wpCI9kJP_5qvuS31Z0MypCpQW0DRel5wZRJjDM19LccmIEsWMnB8S5oALlj5jeXSBuRPLAcDsCy8fZSXve2rOlb8AMXN6UnjBottYShHkobTHECMz6tH2Ani4aZ9M0KPaSnUSCXtqIjbgvzIKep7ut6P4A6KvA0adjbnIFiCtWL3V3-0rmyfWpfMiPurrbldFFEzTHnRSd6-oEHyAvUdGdiFBxpymd4YT-MF3ySd0ElYiO76bn7y0]--></g></svg>
