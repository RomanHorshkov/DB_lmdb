@startuml
!include base.puml

title LMDB Wrapper — Packages (Core / Ops / DB / Security)

skinparam backgroundColor transparent

package "Core" {
  component "Core" as core
    note top of core
    Core:
    - public facade and orchestration
    - owns init / add_op / exec_ops / shutdown
    end note

  package "Ops" {
    component "Ops" as ops
      note right of ops
      Ops:
      - env + DBI setup
      - transaction helpers
      - batched LMDB operations
      end note

    package "DB" {
      component "DB" as db
        note right of db
        DB:
        - DataBase_t and DBI descriptors
        - hides raw LMDB handles from callers
        end note
    }

    package "Security" {
      component "Security" as sec
        note right of sec
        Security:
        - LMDB rc → safety policy
        - central errno mapping and mapsize expansion
        end note
    }
  }
}

component "LMDB C API" as lmdb
component "EMlog" as emlog

core --> Ops
ops --> DB
ops --> Security
db --> lmdb
sec --> lmdb
core --> emlog

@enduml
