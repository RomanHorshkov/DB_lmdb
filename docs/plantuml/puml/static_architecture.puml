@startuml
!include base.puml

title LMDB Wrapper — Packages (Core / Ops / DB / Security)

skinparam backgroundColor transparent

package "Core" {
  component "Core" as core

  package "Ops" {
    component "Ops" as ops

    package "DB" {
      component "DB" as db
    }

    package "Security" {
      component "Security" as sec
    }
  }
}

component "LMDB C API" as lmdb
component "EMlog" as emlog

core --> ops
ops --> db
ops --> sec
db --> lmdb
sec --> lmdb
core --> emlog

note top of core
Core:
- public facade and orchestration
- owns init / add_op / exec_ops / shutdown
end note

note right of ops
Ops:
- env + DBI setup
- transaction helpers
- batched LMDB operations
end note

note right of db
DB:
- DataBase_t and DBI descriptors
- hides raw LMDB handles from callers
end note

note right of sec
Security:
- LMDB rc → safety policy
- central errno mapping and mapsize expansion
end note

@enduml
